function [u] = solver(L,x,P,W)
    A = [L 0 1/2*L^2 0;
         1/2*L^2 0 1/6*L^3 0;
         0 0 1 1;
         -1 1 0 L];
     f = [1/2*(L-x(1))^2 1/6*(L-x(1))^3 1 x(1)]'*P(:,1)' + [1/2*(L-x(2))^2 1/6*(L-x(2))^3 1 x(2)]'*P(:,2)' + [1/2*(L-x(3))^2 1/6*(L-x(3))^3 1 x(3)]'*W';
     u = -inv(A)*f;
     u = u';